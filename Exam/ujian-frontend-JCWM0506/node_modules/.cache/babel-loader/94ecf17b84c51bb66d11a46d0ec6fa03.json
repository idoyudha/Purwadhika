{"ast":null,"code":"var _jsxFileName = \"D:\\\\Course\\\\P\\\\Code\\\\Exam\\\\ujian-frontend-JCWM0506\\\\src\\\\pages\\\\cartPage.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { URL_API } from '../helper';\nimport axios from 'axios';\nimport { updateCart } from '../action/authAction';\nimport { Link } from 'react-router-dom';\nimport { Modal, Input, Button, ModalHeader, ModalBody, ModalFooter, Table, Toast, ToastBody, ToastHeader } from 'reactstrap';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass CartPage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.toggle = () => {\n      console.log('toggle');\n      this.setState({\n        modal: !this.state.modal\n      });\n    };\n\n    this.delete = id => {\n      this.props.cart.splice(id, 1);\n      axios.patch(URL_API + `/users/${this.props.id}`, {\n        cart: this.props.cart\n      }).then(response => {\n        this.props.updateCart([...this.props.cart]);\n      }).catch(err => {\n        console.log(err);\n      });\n    };\n\n    this.removeQty = index => {\n      let id = localStorage.getItem('tkn_id');\n      this.props.updateCart([...this.props.cart]);\n      let cart = this.props.cart;\n      let cartEdit = this.props.cart[index];\n\n      if (cartEdit.qty > -1) {\n        cartEdit.qty -= 1;\n        axios.patch(URL_API + `/users/${id}`, {\n          cart\n        }).then(response => {\n          console.log(response.data);\n        }).catch(error => {\n          console.log(\"Error\", error);\n        });\n      }\n    };\n\n    this.addQty = index => {\n      let product = this.props.product_list;\n      let id = localStorage.getItem('tkn_id');\n      this.props.updateCart([...this.props.cart]);\n      let cart = this.props.cart;\n      let cartEdit = this.props.cart[index];\n      let indexFound = product.findIndex(item => item.name === cartEdit.name);\n      console.log('index', indexFound);\n      console.log('Product stock', product[indexFound].stock);\n\n      if (product[indexFound].stock > this.props.cart[index].qty) {\n        cartEdit.qty += 1;\n        axios.patch(URL_API + `/users/${id}`, {\n          cart\n        }).then(response => {\n          console.log(response.data);\n        }).catch(error => {\n          console.log(\"Error\", error);\n        });\n      } else {\n        alert('Stock is not enough');\n      }\n    };\n\n    this.printTable = () => {\n      let cart = this.props.cart;\n      console.log(cart);\n      return cart.map((item, index) => {\n        return /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            children: index + 1\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: item.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                display: 'flex',\n                alignItems: 'center'\n              },\n              children: [/*#__PURE__*/_jsxDEV(Button, {\n                outline: true,\n                size: \"sm\",\n                onClick: () => this.removeQty(index),\n                children: \"remove\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 86,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Input, {\n                className: \"text-center\",\n                placeholder: \"qty\",\n                value: item.qty,\n                style: {\n                  width: '50%',\n                  display: 'inline-block'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 87,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                outline: true,\n                size: \"sm\",\n                color: \"primary\",\n                onClick: () => this.addQty(index),\n                children: \"add\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 88,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: [\"IDR \", item.subtotal]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              outline: true,\n              color: \"danger\",\n              onClick: () => this.delete(index),\n              className: \"d-flex flex-column align-items-center\",\n              size: \"sm\",\n              children: \"Delete\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 92,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 21\n        }, this);\n      });\n    };\n\n    this.checkOut = () => {\n      console.log('checkout', this.props.cart);\n      let user_id = localStorage.getItem('tkn_id');\n      let email = this.props.email;\n      let cart = this.props.cart;\n      let status = 'UNPAID';\n      console.log(user_id, email, cart);\n      axios.post(URL_API + `/userTransactions`, {\n        user_id,\n        email,\n        cart,\n        status\n      }).then(response => {\n        console.log('Response after post', response);\n      }).catch(error => {\n        console.log(error);\n      });\n    };\n\n    this.state = {\n      data: this.props.product_list\n    };\n  }\n\n  render() {\n    console.log('PROPS', this.props.product_list);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-center my-4\",\n        children: \"User Cart\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(Table, {\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"No\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 124,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Product Name\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 125,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Amount\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 126,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Subtotal\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 127,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"Action\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 128,\n                columnNumber: 25\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: this.printTable()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        color: \"warning\",\n        block: true,\n        onClick: this.toggle,\n        children: \"Check out\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Modal, {\n        isOpen: this.state.modal,\n        toggle: this.toggle,\n        style: {\n          width: '70%'\n        },\n        children: [/*#__PURE__*/_jsxDEV(ModalHeader, {\n          toggle: this.toggle,\n          charCode: \"x\",\n          children: \"User Confirmation\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(ModalBody, {\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Will pay after this\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(ModalFooter, {\n          className: \"d-flex justify-content-between\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            className: \"d-flex justify-content-center\",\n            outline: true,\n            color: \"secondary\",\n            onClick: this.toggle,\n            children: \"Continue Shopping\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/checkout\",\n            style: {\n              textDecoration: 'none'\n            },\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              onClick: this.checkOut,\n              className: \"d-flex justify-content-center\",\n              color: \"success\",\n              children: \"Go to shopping cart\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 25\n            }, this), ' ']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nconst mapStateToProps = ({\n  authReducer,\n  productReducers\n}) => {\n  return { ...authReducer,\n    ...productReducers\n  };\n};\n\nexport default connect(mapStateToProps, {\n  updateCart\n})(CartPage);","map":{"version":3,"sources":["D:/Course/P/Code/Exam/ujian-frontend-JCWM0506/src/pages/cartPage.js"],"names":["React","Component","connect","URL_API","axios","updateCart","Link","Modal","Input","Button","ModalHeader","ModalBody","ModalFooter","Table","Toast","ToastBody","ToastHeader","CartPage","constructor","props","toggle","console","log","setState","modal","state","delete","id","cart","splice","patch","then","response","catch","err","removeQty","index","localStorage","getItem","cartEdit","qty","data","error","addQty","product","product_list","indexFound","findIndex","item","name","stock","alert","printTable","map","display","alignItems","width","subtotal","checkOut","user_id","email","status","post","render","textDecoration","mapStateToProps","authReducer","productReducers"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { URL_API } from '../helper';\r\nimport axios from 'axios';\r\nimport { updateCart } from '../action/authAction'\r\nimport { Link } from 'react-router-dom';\r\nimport { Modal, Input, Button, ModalHeader, ModalBody, ModalFooter, Table, Toast, ToastBody, ToastHeader } from 'reactstrap';\r\n\r\nclass CartPage extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {  \r\n            data: this.props.product_list\r\n        }\r\n    }\r\n\r\n    toggle = () => {\r\n        console.log('toggle')\r\n        this.setState({ modal: !this.state.modal })\r\n    }\r\n\r\n    delete = (id) => {\r\n        this.props.cart.splice(id, 1)\r\n        axios.patch(URL_API + `/users/${this.props.id}`, { cart: this.props.cart })\r\n            .then(response => {\r\n                this.props.updateCart([...this.props.cart])\r\n            }).catch(err => {\r\n                console.log(err)\r\n            })\r\n    } \r\n\r\n    removeQty = (index) => {\r\n        let id = localStorage.getItem('tkn_id')\r\n        this.props.updateCart([...this.props.cart])\r\n        let cart = this.props.cart\r\n        let cartEdit = this.props.cart[index]\r\n        if (cartEdit.qty > -1) {\r\n            cartEdit.qty -= 1\r\n            axios.patch(URL_API+`/users/${id}`, {\r\n                cart\r\n            })\r\n            .then(response => {\r\n                console.log(response.data)\r\n            })\r\n            .catch(error => {\r\n                console.log(\"Error\", error)\r\n            })    \r\n        }\r\n    }\r\n\r\n    addQty = (index) => {\r\n        let product = this.props.product_list\r\n        let id = localStorage.getItem('tkn_id')\r\n        this.props.updateCart([...this.props.cart])\r\n        let cart = this.props.cart\r\n        let cartEdit = this.props.cart[index]\r\n        let indexFound = product.findIndex(item => item.name === cartEdit.name)\r\n        console.log('index', indexFound)\r\n        console.log('Product stock', product[indexFound].stock)\r\n        if (product[indexFound].stock > this.props.cart[index].qty) {\r\n            cartEdit.qty += 1\r\n            axios.patch(URL_API+`/users/${id}`, {\r\n                cart\r\n            })\r\n            .then(response => {\r\n                console.log(response.data)\r\n            })\r\n            .catch(error => {\r\n                console.log(\"Error\", error)\r\n            })          \r\n        }\r\n        else {\r\n            alert('Stock is not enough')\r\n        }\r\n    }\r\n    \r\n    printTable = () => {\r\n        let cart = this.props.cart\r\n        console.log(cart)\r\n        return cart.map((item, index) => {\r\n            return  <tr>\r\n                        <th>{index+1}</th>\r\n                        <td>{item.name}</td>\r\n                        <td>\r\n                            <span style={{display: 'flex', alignItems:'center'}}>\r\n                                <Button outline size=\"sm\" onClick={() => this.removeQty(index)}>remove</Button>\r\n                                <Input className=\"text-center\" placeholder='qty' value={item.qty} style={{width: '50%', display:'inline-block'}} />\r\n                                <Button outline size=\"sm\" color=\"primary\" onClick={() => this.addQty(index)}>add</Button>\r\n                            </span>\r\n                        </td>\r\n                        <td>IDR {item.subtotal}</td>\r\n                        <td><Button outline color=\"danger\" onClick={() => this.delete(index)} className=\"d-flex flex-column align-items-center\" size=\"sm\">Delete</Button></td>\r\n                    </tr>\r\n        })\r\n    }\r\n\r\n    checkOut = () => {\r\n        console.log('checkout', this.props.cart)\r\n        let user_id = localStorage.getItem('tkn_id')\r\n        let email = this.props.email\r\n        let cart = this.props.cart \r\n        let status = 'UNPAID'\r\n        console.log(user_id, email, cart)\r\n        axios.post(URL_API+`/userTransactions`, {\r\n            user_id, email, cart, status\r\n        })\r\n        .then(response => {\r\n            console.log('Response after post', response)\r\n        })\r\n        .catch(error => {\r\n            console.log(error)\r\n        })\r\n    }\r\n\r\n    render() {\r\n        console.log('PROPS', this.props.product_list)\r\n        return (  \r\n            <div className=\"container\">\r\n                <h1 className=\"text-center my-4\">User Cart</h1>\r\n                <div>\r\n                <Table>\r\n                    <thead>\r\n                        <tr>\r\n                        <th>No</th>\r\n                        <th>Product Name</th>\r\n                        <th>Amount</th>\r\n                        <th>Subtotal</th>\r\n                        <th>Action</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                    {this.printTable()}\r\n                    </tbody>\r\n                </Table>\r\n                </div>\r\n                <Button color=\"warning\" block onClick={this.toggle}>Check out</Button>\r\n                <Modal isOpen={this.state.modal} toggle={this.toggle} style={{width: '70%'}}>\r\n                <ModalHeader toggle={this.toggle} charCode=\"x\">User Confirmation</ModalHeader>\r\n                <ModalBody>\r\n                <p>Will pay after this</p>\r\n                </ModalBody>\r\n                <ModalFooter className=\"d-flex justify-content-between\">\r\n                    <Button className=\"d-flex justify-content-center\" outline color=\"secondary\" onClick={this.toggle}>Continue Shopping</Button>\r\n                    <Link to=\"/checkout\" style={{textDecoration: 'none'}}>\r\n                        <Button onClick={this.checkOut} className=\"d-flex justify-content-center\" color=\"success\">Go to shopping cart</Button>{' '}\r\n                    </Link>\r\n                </ModalFooter>\r\n                </Modal>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = ({ authReducer, productReducers }) => {\r\n    return {\r\n        ...authReducer,\r\n        ...productReducers\r\n    }\r\n} \r\n\r\nexport default connect(mapStateToProps, {updateCart}) (CartPage);"]},"metadata":{},"sourceType":"module"}